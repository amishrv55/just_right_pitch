{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <div class="mt-3">
    <a href="{% url 'export_payments_csv' %}" class="btn btn-outline-dark btn-sm">ðŸ“„ Export CSV</a>
    <a href="{% url 'export_payments_excel' %}" class="btn btn-outline-success btn-sm">ðŸ“Š Export Excel</a>
    </div>

    <br>
    <br>

    <h3 class="mb-4 text-primary">Payment Track for Proposal #{{ proposal.id }}</h3>
    <p><strong>Project Platform:</strong> {{ proposal.platform }}</p>
    <p><strong>Status:</strong> {{ proposal.status }}</p>

    {% if payments %}
    <div class="timeline">
        {% for payment in payments %}
        <div class="timeline-item mb-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Payment #{{ forloop.counter }}</h5>
                    <p><strong>Amount:</strong> ${{ payment.amount }}</p>
                    <p><strong>Status:</strong> 
                        {% if payment.status == "Received" %}
                            <span class="badge bg-success">{{ payment.status }}</span>
                        {% else %}
                            <span class="badge bg-warning text-dark">{{ payment.status }}</span>
                        {% endif %}
                    </p>
                    {% if payment.due_date %}
                        <p><strong>Due Date:</strong> {{ payment.due_date }}</p>
                    {% endif %}
                    {% if payment.received_date %}
                        <p><strong>Received Date:</strong> {{ payment.received_date }}</p>
                    {% endif %}
                    <small class="text-muted">Recorded on {{ payment.created_at|date:"Y-m-d H:i" }}</small>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
        <div class="alert alert-info">No payment records found for this project.</div>
    {% endif %}

    <div class="mt-3">
        <a href="{% url 'dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
    </div>
</div>

<style>
/* Simple vertical timeline look */
.timeline {
    position: relative;
    margin-left: 20px;
}
.timeline::before {
    content: "";
    position: absolute;
    left: -12px;
    top: 0;
    bottom: 0;
    width: 4px;
    background: #0d6efd;
}
.timeline-item {
    position: relative;
}
.timeline-item::before {
    content: "";
    position: absolute;
    left: -20px;
    top: 20px;
    width: 12px;
    height: 12px;
    background: #0d6efd;
    border-radius: 50%;
}
</style>
{% endblock %}
